<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Social Media Post Adapter</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #e8d5ff 0%, #b8e6ff 50%, #f0e6d6 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            background: linear-gradient(45deg, #8e44ad, #3498db);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 10px;
            position: relative;
        }

        .hidden-trigger {
            position: absolute;
            top: 10px;
            right: 10px;
            cursor: pointer;
            opacity: 0.02;
            transition: all 0.3s;
            font-size: 0.6rem;
            user-select: none;
            padding: 1px;
            border-radius: 50%;
            background: transparent;
        }

        .hidden-trigger:hover {
            opacity: 0.3;
            transform: rotate(30deg);
            background: rgba(142, 68, 173, 0.05);
            font-size: 0.7rem;
        }

        .x-rated-option {
            display: none !important;
            animation: slideIn 0.3s ease-out;
        }

        .x-rated-option.revealed {
            display: flex !important;
        }

        .x-rated-option .checkbox-item {
            border: 2px solid #e74c3c;
            border-radius: 6px;
            padding: 8px;
            background: rgba(231, 76, 60, 0.1);
        }

        .x-rated-option label {
            color: #e74c3c;
            font-weight: 600;
        }

        .x-rated-option .option-description {
            color: #c0392b;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .age-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 10000;
            display: flex;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease-out;
        }

        .age-modal-content {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3);
            max-width: 450px;
            width: 90%;
            text-align: center;
            animation: modalSlideIn 0.3s ease-out;
        }

        .age-modal-content h3 {
            color: #e74c3c;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }

        .age-modal-content p {
            margin-bottom: 15px;
            line-height: 1.4;
            color: #333;
        }

        .age-modal-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 20px 0;
        }

        .age-btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .age-yes {
            background: #27ae60;
            color: white;
        }

        .age-yes:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(39, 174, 96, 0.3);
        }

        .age-no {
            background: #e74c3c;
            color: white;
        }

        .age-no:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(231, 76, 60, 0.3);
        }

        .age-modal-footer {
            border-top: 1px solid #eee;
            padding-top: 15px;
            margin-top: 20px;
        }

        .age-modal-footer small {
            color: #666;
            font-style: italic;
            line-height: 1.3;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes modalSlideIn {
            from { opacity: 0; transform: translateY(-50px) scale(0.95); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        .header p {
            color: #666;
            font-size: 1.1rem;
        }

        .input-section {
            background: rgba(255, 255, 255, 0.9);
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .post-label {
            display: block;
            font-weight: 600;
            color: #5d4e75;
            margin-bottom: 8px;
            font-size: 16px;
        }

        .main-input {
            width: 100%;
            min-height: 120px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-size: 16px;
            font-family: inherit;
            resize: vertical;
            margin-bottom: 8px;
            transition: border-color 0.3s;
        }

        .post-guidance {
            margin-bottom: 20px;
        }

        .guidance-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .char-counter {
            font-size: 12px;
            font-weight: 600;
            color: #666;
        }

        .char-counter.over-limit {
            color: #e74c3c;
        }

        .guidance-text {
            font-size: 12px;
            color: #8e44ad;
            font-style: italic;
        }

        .main-input:focus {
            outline: none;
            border-color: #8e44ad;
        }

        .links-section {
            margin-bottom: 20px;
        }

        .links-label {
            display: block;
            font-weight: 600;
            color: #5d4e75;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .links-input {
            width: 100%;
            min-height: 80px;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            resize: vertical;
            margin-bottom: 8px;
            transition: border-color 0.3s;
            background: rgba(255, 255, 255, 0.8);
        }

        .links-input:focus {
            outline: none;
            border-color: #8e44ad;
        }

        .links-description {
            font-size: 12px;
            color: #666;
            font-style: italic;
            line-height: 1.3;
        }

        .notes-section {
            margin-bottom: 20px;
        }

        .notes-label {
            display: block;
            font-weight: 600;
            color: #8e44ad;
            margin-bottom: 8px;
            font-size: 14px;
        }

        .notes-input {
            width: 100%;
            min-height: 90px;
            padding: 12px;
            border: 2px solid #e8d5ff;
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            resize: vertical;
            margin-bottom: 8px;
            transition: border-color 0.3s;
            background: rgba(232, 213, 255, 0.3);
        }

        .notes-input:focus {
            outline: none;
            border-color: #8e44ad;
            background: rgba(232, 213, 255, 0.5);
        }

        .notes-description {
            font-size: 12px;
            color: #8e44ad;
            font-style: italic;
            line-height: 1.3;
            font-weight: 500;
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .option-group {
            background: rgba(255, 255, 255, 0.7);
            padding: 15px;
            border-radius: 8px;
            border: 1px solid #ddd;
        }

        .option-group h3 {
            margin-bottom: 10px;
            color: #5d4e75;
            font-size: 1rem;
        }

        .checkbox-group {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            margin-bottom: 5px;
            flex: 1;
            min-width: 120px;
        }

        .checkbox-item input[type="checkbox"] {
            margin-right: 8px;
            transform: scale(1.1);
        }

        .checkbox-item label {
            font-size: 14px;
            cursor: pointer;
        }

        .option-description {
            font-size: 11px;
            color: #888;
            margin-left: 20px;
            font-style: italic;
            line-height: 1.2;
        }

        .generate-btn {
            background: linear-gradient(45deg, #8e44ad, #3498db);
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 25px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            display: block;
            margin: 0 auto;
        }

        .generate-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(142, 68, 173, 0.3);
        }

        .generate-btn:disabled {
            opacity: 0.7;
            cursor: not-allowed;
            transform: none;
        }

        .loading {
            text-align: center;
            margin: 20px 0;
            display: none;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 4px solid #f3f3f3;
            border-top: 4px solid #8e44ad;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 10px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .copy-all-section {
            text-align: center;
            margin: 20px 0;
            padding: 20px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .copy-all-btn {
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin-bottom: 8px;
        }

        .copy-all-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(39, 174, 96, 0.3);
        }

        .copy-all-btn.copied {
            background: linear-gradient(45deg, #8e44ad, #9b59b6);
        }

        .copy-all-description {
            font-size: 12px;
            color: #666;
            font-style: italic;
        }

        .outputs-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .blog-output {
            grid-column: 1 / -1;
            max-width: 800px;
            margin: 0 auto;
        }

        .output-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: transform 0.2s;
        }

        .output-card:hover {
            transform: translateY(-2px);
        }

        .platform-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #f0f0f0;
        }

        .platform-name {
            font-size: 1.3rem;
            font-weight: 600;
            color: #5d4e75;
        }

        .platform-icons {
            display: flex;
            gap: 10px;
        }

        .icon-instagram { background: linear-gradient(45deg, #f09433, #e6683c, #dc2743, #cc2366, #bc1888); }
        .icon-x { background: #000; }
        .icon-linkedin { background: #0077b5; }
        .icon-mastodon { background: #563acc; }
        .icon-bluesky { background: #00aaff; }
        .icon-tiktok { background: linear-gradient(45deg, #ff0050, #00f5ff); }
        .icon-blog { background: linear-gradient(45deg, #8e44ad, #f39c12); }

        .platform-icon {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .output-textarea {
            width: 100%;
            min-height: 100px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            resize: vertical;
            margin-bottom: 15px;
            background: rgba(255, 255, 255, 0.8);
            text-indent: 0;
            padding-left: 15px;
        }

        .output-textarea:focus {
            outline: none;
            border-color: #8e44ad;
        }

        .links-input {
            width: 100%;
            min-height: 80px;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            resize: vertical;
            margin-bottom: 8px;
            transition: border-color 0.3s;
            background: rgba(255, 255, 255, 0.8);
            text-indent: 0;
            padding-left: 12px;
        }

        .notes-input {
            width: 100%;
            min-height: 90px;
            padding: 12px;
            border: 2px solid #e8d5ff;
            border-radius: 8px;
            font-size: 14px;
            font-family: inherit;
            resize: vertical;
            margin-bottom: 8px;
            transition: border-color 0.3s;
            background: rgba(232, 213, 255, 0.3);
            text-indent: 0;
            padding-left: 12px;
        }

        .blog-textarea {
            min-height: 200px;
        }

        .output-actions {
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .copy-btn {
            background: #27ae60;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 12px;
            transition: background 0.2s;
        }

        .copy-btn:hover {
            background: #229954;
        }

        .copy-btn.copied {
            background: #8e44ad;
        }

        .output-info {
            font-size: 12px;
            color: #666;
            line-height: 1.4;
        }

        .char-count {
            font-weight: 600;
        }

        .char-count.over-limit {
            color: #e74c3c;
        }

        .char-count.optimal {
            color: #27ae60;
        }

        .donate-section {
            background: rgba(255, 255, 255, 0.9);
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            margin-top: 30px;
            text-align: center;
        }

        .donate-section h3 {
            color: #5d4e75;
            margin-bottom: 10px;
        }

        .donate-section p {
            color: #666;
            margin-bottom: 15px;
        }

        .donate-btn {
            background: linear-gradient(45deg, #f39c12, #e67e22);
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 20px;
            font-size: 16px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
            transition: transform 0.2s;
        }

        .donate-btn:hover {
            transform: translateY(-1px);
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2rem;
            }
            
            .options-grid {
                grid-template-columns: 1fr;
            }
            
            .outputs-grid {
                grid-template-columns: 1fr;
            }
            
            .checkbox-group {
                flex-direction: column;
            }
            
            .checkbox-item {
                min-width: auto;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Social Media Post Adapter</h1>
            <p>Optimize your posts for maximum engagement across all platforms</p>
            <div class="hidden-trigger" id="hiddenTrigger" title="Advanced Options">‚öôÔ∏è</div>
        </div>

        <div class="input-section">
            <label for="originalPost" class="post-label">Your Original Post</label>
            <textarea 
                class="main-input" 
                id="originalPost" 
                placeholder="Type your post here...">
            </textarea>
            <div class="post-guidance">
                <div class="guidance-row">
                    <span class="char-counter" id="postCharCount">0 / 2000 characters</span>
                    <span class="guidance-text">Min: 10 characters ‚Ä¢ Keep it authentic and conversational</span>
                </div>
            </div>
            
            <div class="links-section">
                <label for="referenceLinks" class="links-label">Reference Links (optional)</label>
                <textarea 
                    class="links-input" 
                    id="referenceLinks" 
                    placeholder="Add reference links here (optional - one per line)&#10;&#10;Examples:&#10;https://myportfolio.com/project&#10;https://youtube.com/watch?v=demo&#10;https://github.com/myrepo&#10;https://blog.example.com/article&#10;&#10;Claude will incorporate context from these links into your adapted posts">
                </textarea>
                <div class="links-description">Add links that relate to your post content. Claude will reference these when adapting your posts.</div>
            </div>

            <div class="notes-section">
                <label for="internalNotes" class="notes-label">Internal Notes to Claude (optional)</label>
                <textarea 
                    class="notes-input" 
                    id="internalNotes" 
                    placeholder="Private instructions for Claude (optional - won't appear in final posts)&#10;&#10;Examples:&#10;‚Ä¢ Focus on the technical innovation aspects&#10;‚Ä¢ Keep it humble despite this being a big achievement&#10;‚Ä¢ Target audience is beginners, use simple language&#10;‚Ä¢ This was actually quite challenging, show some struggle&#10;‚Ä¢ Make it sound more confident than I actually feel&#10;‚Ä¢ Emphasize the community/collaboration angle&#10;‚Ä¢ Avoid mentioning specific companies or competitors&#10;&#10;These notes guide how Claude adapts your content but won't appear in the final posts">
                </textarea>
                <div class="notes-description">Private instructions for Claude. This content will guide the adaptation but won't appear in your final posts.</div>
            </div>
            
            <div class="options-grid">
                <div class="option-group">
                    <h3>Content Modifications</h3>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="hashtags" checked>
                            <label for="hashtags">Add Hashtags</label>
                            <div class="option-description">Include relevant hashtags for discovery</div>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="topics" checked>
                            <label for="topics">Enhance Topics</label>
                            <div class="option-description">Expand themes & keywords for better reach</div>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="addEmojis">
                            <label for="addEmojis">Add Emojis</label>
                            <div class="option-description">Include relevant emojis for engagement</div>
                        </div>
                    </div>
                </div>
                
                <div class="option-group">
                    <h3>Tone & Style</h3>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="autoAdapt" checked>
                            <label for="autoAdapt">Auto-adapt to platform</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="uplifting">
                            <label for="uplifting">Uplifting</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="professional">
                            <label for="professional">Professional</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="casual">
                            <label for="casual">Casual</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="creative">
                            <label for="creative">Creative</label>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="educational">
                            <label for="educational">Educational</label>
                        </div>
                    </div>
                </div>

                <div class="option-group">
                    <h3>Language & Voice</h3>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="useCurrentSlang">
                            <label for="useCurrentSlang">Use Current Slang</label>
                            <div class="option-description">Include recent internet slang and expressions</div>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="allowProfanity">
                            <label for="allowProfanity">Allow Profanity</label>
                            <div class="option-description">Permits strong language when appropriate</div>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="spicy">
                            <label for="spicy">Irritated/Spicy</label>
                            <div class="option-description">Adds frustrated or edgy tone to content</div>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="controversy">
                            <label for="controversy">Controversy/Hot Takes</label>
                            <div class="option-description">Include mildly controversial opinions for engagement</div>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="seductive">
                            <label for="seductive">Seductive</label>
                            <div class="option-description">Adds alluring and captivating language</div>
                        </div>
                        <div class="checkbox-item x-rated-option" id="xRatedOption">
                            <input type="checkbox" id="xRated">
                            <label for="xRated">X-Rated Content</label>
                            <div class="option-description">Suggestive creative writing with mature themes (18+)</div>
                        </div>
                    </div>
                </div>
                
                <div class="option-group">
                    <h3>Audience Focus</h3>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="personalBrand">
                            <label for="personalBrand">Personal Brand</label>
                            <div class="option-description">Write from individual perspective vs company</div>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="businessFocus">
                            <label for="businessFocus">Business Focus</label>
                            <div class="option-description">Target professional business audience</div>
                        </div>
                    </div>
                </div>

                <div class="option-group">
                    <h3>Engagement Elements</h3>
                    <div class="checkbox-group">
                        <div class="checkbox-item">
                            <input type="checkbox" id="callToAction">
                            <label for="callToAction">Include Call-to-Action</label>
                            <div class="option-description">Add engagement prompts (like, share, comment)</div>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="includeQuestions">
                            <label for="includeQuestions">Include Questions</label>
                            <div class="option-description">End with engaging questions for comments</div>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="storyElements">
                            <label for="storyElements">Add Story Elements</label>
                            <div class="option-description">Include narrative hooks and storytelling</div>
                        </div>
                        <div class="checkbox-item">
                            <input type="checkbox" id="behindScenes">
                            <label for="behindScenes">Behind the Scenes</label>
                            <div class="option-description">Add personal insights and process details</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <button class="generate-btn" id="generateBtn" onclick="generatePosts()">
                Generate Adapted Posts
            </button>
        </div>

        <div class="loading" id="loadingIndicator">
            <div class="loading-spinner"></div>
            <p>Adapting your post for all platforms...</p>
        </div>

        <div class="copy-all-section" id="copyAllSection" style="display: none;">
            <button class="copy-all-btn" id="copyAllBtn" onclick="copyAllPosts()">
                üìã Copy All Posts
            </button>
            <div class="copy-all-description">Copy all platform adaptations to clipboard for easy batch posting</div>
        </div>

        <div class="outputs-grid" id="outputsGrid" style="display: none;">
            <div class="output-card">
                <div class="platform-header">
                    <span class="platform-name">Instagram</span>
                    <div class="platform-icons">
                        <div class="platform-icon icon-instagram"></div>
                    </div>
                </div>
                <textarea class="output-textarea" id="instagramOutput"></textarea>
                <div class="output-actions">
                    <button class="copy-btn" onclick="copyToClipboard('instagramOutput', this)">Copy</button>
                    <div class="output-info">
                        <div class="char-count" id="instagramCount">0 characters</div>
                        <div>Optimal: 125 chars, 5-9 hashtags</div>
                    </div>
                </div>
            </div>

            <div class="output-card">
                <div class="platform-header">
                    <span class="platform-name">X (Twitter)</span>
                    <div class="platform-icons">
                        <div class="platform-icon icon-x"></div>
                    </div>
                </div>
                <textarea class="output-textarea" id="xOutput"></textarea>
                <div class="output-actions">
                    <button class="copy-btn" onclick="copyToClipboard('xOutput', this)">Copy</button>
                    <div class="output-info">
                        <div class="char-count" id="xCount">0 characters</div>
                        <div>Optimal: 71-100 chars, 1-2 hashtags</div>
                    </div>
                </div>
            </div>

            <div class="output-card">
                <div class="platform-header">
                    <span class="platform-name">LinkedIn</span>
                    <div class="platform-icons">
                        <div class="platform-icon icon-linkedin"></div>
                    </div>
                </div>
                <textarea class="output-textarea" id="linkedinOutput"></textarea>
                <div class="output-actions">
                    <button class="copy-btn" onclick="copyToClipboard('linkedinOutput', this)">Copy</button>
                    <div class="output-info">
                        <div class="char-count" id="linkedinCount">0 characters</div>
                        <div>Optimal: ~100 chars, 3 hashtags</div>
                    </div>
                </div>
            </div>

            <div class="output-card">
                <div class="platform-header">
                    <span class="platform-name">Mastodon</span>
                    <div class="platform-icons">
                        <div class="platform-icon icon-mastodon"></div>
                    </div>
                </div>
                <textarea class="output-textarea" id="mastodonOutput"></textarea>
                <div class="output-actions">
                    <button class="copy-btn" onclick="copyToClipboard('mastodonOutput', this)">Copy</button>
                    <div class="output-info">
                        <div class="char-count" id="mastodonCount">0 characters</div>
                        <div>Limit: 500 chars, 3-5 hashtags</div>
                    </div>
                </div>
            </div>

            <div class="output-card">
                <div class="platform-header">
                    <span class="platform-name">BlueSky</span>
                    <div class="platform-icons">
                        <div class="platform-icon icon-bluesky"></div>
                    </div>
                </div>
                <textarea class="output-textarea" id="blueskyOutput"></textarea>
                <div class="output-actions">
                    <button class="copy-btn" onclick="copyToClipboard('blueskyOutput', this)">Copy</button>
                    <div class="output-info">
                        <div class="char-count" id="blueskyCount">0 characters</div>
                        <div>Limit: 300 chars, 2-4 hashtags</div>
                    </div>
                </div>
            </div>

            <div class="output-card">
                <div class="platform-header">
                    <span class="platform-name">TikTok</span>
                    <div class="platform-icons">
                        <div class="platform-icon icon-tiktok"></div>
                    </div>
                </div>
                <textarea class="output-textarea" id="tiktokOutput"></textarea>
                <div class="output-actions">
                    <button class="copy-btn" onclick="copyToClipboard('tiktokOutput', this)">Copy</button>
                    <div class="output-info">
                        <div class="char-count" id="tiktokCount">0 characters</div>
                        <div>Brief description, 3-5 hashtags</div>
                    </div>
                </div>
            </div>

            <div class="output-card blog-output">
                <div class="platform-header">
                    <span class="platform-name">Blog Post</span>
                    <div class="platform-icons">
                        <div class="platform-icon icon-blog"></div>
                    </div>
                </div>
                <textarea class="output-textarea blog-textarea" id="blogOutput"></textarea>
                <div class="output-actions">
                    <button class="copy-btn" onclick="copyToClipboard('blogOutput', this)">Copy</button>
                    <div class="output-info">
                        <div class="char-count" id="blogCount">0 characters</div>
                        <div>Longer format, 3-5 relevant hashtags</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="donate-section">
            <h3>Support This Tool</h3>
            <p>This tool uses the Claude API which incurs costs. Your donations help keep it running!</p>
            <a href="https://ko-fi.com/s/4dc4d3d43a" class="donate-btn" target="_blank">‚òï Buy me a coffee</a>
        </div>
    </div>

    <!-- Age Verification Modal -->
    <div class="age-modal" id="ageModal" style="display: none;">
        <div class="age-modal-content">
            <h3>Age Verification Required</h3>
            <p>The X-Rated Content feature is intended for creative writing purposes only and contains mature themes suitable for adults.</p>
            <p><strong>Are you 18 years of age or older?</strong></p>
            <div class="age-modal-buttons">
                <button class="age-btn age-yes" id="ageYes">Yes, I am 18+</button>
                <button class="age-btn age-no" id="ageNo">No, I am under 18</button>
            </div>
            <div class="age-modal-footer">
                <small>This feature is for legitimate creative writing purposes such as fantasy novels, adult fiction, and literary content.</small>
            </div>
        </div>
    </div>

    <script>
        // Character count tracking
        function updateCharacterCount(textareaId, countId, optimalRange) {
            const textarea = document.getElementById(textareaId);
            const countElement = document.getElementById(countId);
            
            textarea.addEventListener('input', function() {
                const length = textarea.value.length;
                countElement.textContent = `${length} characters`;
                
                // Color coding based on optimal ranges
                countElement.className = 'char-count';
                if (optimalRange) {
                    if (length >= optimalRange.min && length <= optimalRange.max) {
                        countElement.classList.add('optimal');
                    } else if (length > optimalRange.max + 50) {
                        countElement.classList.add('over-limit');
                    }
                }
            });
        }

        // Initialize character counting
        document.addEventListener('DOMContentLoaded', function() {
            updateCharacterCount('instagramOutput', 'instagramCount', {min: 100, max: 125});
            updateCharacterCount('xOutput', 'xCount', {min: 71, max: 100});
            updateCharacterCount('linkedinOutput', 'linkedinCount', {min: 80, max: 100});
            updateCharacterCount('mastodonOutput', 'mastodonCount', {min: 200, max: 500});
            updateCharacterCount('blueskyOutput', 'blueskyCount', {min: 200, max: 300});
            updateCharacterCount('tiktokOutput', 'tiktokCount', {min: 50, max: 150});
            updateCharacterCount('blogOutput', 'blogCount', null);

            // Add character counting for main input
            const mainInput = document.getElementById('originalPost');
            const charCounter = document.getElementById('postCharCount');
            
            mainInput.addEventListener('input', function() {
                const length = mainInput.value.length;
                charCounter.textContent = `${length} / 2000 characters`;
                
                if (length > 2000) {
                    charCounter.classList.add('over-limit');
                } else {
                    charCounter.classList.remove('over-limit');
                }
            });

            // Hidden trigger for adult content options
            const hiddenTrigger = document.getElementById('hiddenTrigger');
            const xRatedOption = document.getElementById('xRatedOption');
            const ageModal = document.getElementById('ageModal');
            const ageYes = document.getElementById('ageYes');
            const ageNo = document.getElementById('ageNo');
            let clickCount = 0;
            let ageVerified = false;
            
            console.log('Hidden trigger initialized:', hiddenTrigger);
            
            hiddenTrigger.addEventListener('click', function() {
                clickCount++;
                console.log('Hidden trigger clicked, count:', clickCount);
                
                if (clickCount === 3) {
                    console.log('Triple click detected, age verified:', ageVerified);
                    
                    if (!ageVerified) {
                        console.log('Showing age verification modal');
                        ageModal.style.display = 'flex';
                    } else {
                        console.log('Age already verified, showing X-rated option');
                        xRatedOption.classList.add('revealed');
                        hiddenTrigger.style.display = 'none';
                    }
                }
                
                // Reset click count after 2 seconds
                setTimeout(() => {
                    if (clickCount < 3) {
                        console.log('Click count reset');
                        clickCount = 0;
                    }
                }, 2000);
            });

            // Age verification handlers
            ageYes.addEventListener('click', function() {
                console.log('Age verification: Yes clicked');
                ageVerified = true;
                ageModal.style.display = 'none';
                xRatedOption.classList.add('revealed');
                hiddenTrigger.style.display = 'none';
                
                // Store verification in session (not persistent)
                sessionStorage.setItem('ageVerified', 'true');
                console.log('X-rated content option revealed');
            });

            ageNo.addEventListener('click', function() {
                console.log('Age verification: No clicked');
                ageModal.style.display = 'none';
                alert('Adult content features are not available for users under 18.');
                clickCount = 0;
            });

            // Check if age was already verified in this session
            if (sessionStorage.getItem('ageVerified') === 'true') {
                console.log('Age verification found in session storage');
                ageVerified = true;
            }

            // Close modal if clicked outside
            ageModal.addEventListener('click', function(e) {
                if (e.target === ageModal) {
                    console.log('Modal closed by clicking outside');
                    ageModal.style.display = 'none';
                }
            });
        });

        // Copy to clipboard function
        async function copyToClipboard(textareaId, buttonElement) {
            const textarea = document.getElementById(textareaId);
            try {
                await navigator.clipboard.writeText(textarea.value);
                buttonElement.textContent = 'Copied!';
                buttonElement.classList.add('copied');
                setTimeout(() => {
                    buttonElement.textContent = 'Copy';
                    buttonElement.classList.remove('copied');
                }, 2000);
            } catch (err) {
                console.error('Failed to copy: ', err);
            }
        }

        // Get selected options
        function getSelectedOptions() {
            const options = {
                contentMods: [],
                tones: [],
                languageVoice: [],
                audienceFocus: [],
                engagementElements: [],
                characterStrategy: 'optimal' // Always use optimal now
            };

            // Content Modifications
            if (document.getElementById('hashtags').checked) options.contentMods.push('add relevant hashtags');
            if (document.getElementById('topics').checked) options.contentMods.push('enhance topics and themes for better discoverability');
            if (document.getElementById('addEmojis').checked) options.contentMods.push('add relevant emojis for engagement');

            // Tone & Style
            if (document.getElementById('autoAdapt').checked) options.tones.push('auto-adapt to platform audience');
            if (document.getElementById('uplifting').checked) options.tones.push('uplifting');
            if (document.getElementById('professional').checked) options.tones.push('professional');
            if (document.getElementById('casual').checked) options.tones.push('casual');
            if (document.getElementById('creative').checked) options.tones.push('creative');
            if (document.getElementById('educational').checked) options.tones.push('educational');

            // Language & Voice
            if (document.getElementById('useCurrentSlang').checked) options.languageVoice.push('use current internet slang and expressions');
            if (document.getElementById('allowProfanity').checked) options.languageVoice.push('allow profanity when appropriate');
            if (document.getElementById('spicy').checked) options.languageVoice.push('irritated/spicy tone');
            if (document.getElementById('controversy').checked) options.languageVoice.push('include mildly controversial opinions for engagement');
            if (document.getElementById('seductive').checked) options.languageVoice.push('use seductive and alluring language');
            if (document.getElementById('xRated').checked) options.languageVoice.push('use suggestive and provocative language appropriate for mature creative writing, with sensual metaphors, double entendres, and creative visual descriptions that imply rather than state explicitly');

            // Audience Focus
            if (document.getElementById('personalBrand').checked) options.audienceFocus.push('write from individual perspective rather than company voice');
            if (document.getElementById('businessFocus').checked) options.audienceFocus.push('target professional business audience');

            // Engagement Elements
            if (document.getElementById('callToAction').checked) options.engagementElements.push('include call-to-action prompts');
            if (document.getElementById('includeQuestions').checked) options.engagementElements.push('end with engaging questions for comments');
            if (document.getElementById('storyElements').checked) options.engagementElements.push('include narrative hooks and storytelling elements');
            if (document.getElementById('behindScenes').checked) options.engagementElements.push('add behind-the-scenes insights and process details');

            return options;
        }

        // Generate posts using Claude API
        async function generatePosts() {
            const originalPost = document.getElementById('originalPost').value.trim();
            const referenceLinks = document.getElementById('referenceLinks').value.trim();
            const internalNotes = document.getElementById('internalNotes').value.trim();
            
            if (!originalPost) {
                alert('Please enter a post to adapt!');
                return;
            }

            // Check minimum length
            if (originalPost.length < 10) {
                alert('Post is too short. Please enter at least 10 characters.');
                return;
            }

            // Check maximum length
            if (originalPost.length > 2000) {
                alert('Post is too long. Please keep it under 2000 characters.');
                return;
            }

            // Validate links if provided
            let validatedLinks = [];
            if (referenceLinks) {
                const links = referenceLinks.split('\n').filter(link => link.trim());
                
                // Basic URL validation
                const urlPattern = /^https?:\/\/[^\s$.?#].[^\s]*$/i;
                for (let link of links) {
                    link = link.trim();
                    if (link && !urlPattern.test(link)) {
                        alert(`Invalid URL format: ${link}\nPlease use format: https://example.com`);
                        return;
                    }
                    if (link) validatedLinks.push(link);
                }

                // Limit number of links
                if (validatedLinks.length > 5) {
                    alert('Please limit to 5 reference links maximum.');
                    return;
                }
            }

            // Validate internal notes length (reasonable limit)
            if (internalNotes.length > 1000) {
                alert('Internal notes too long. Please keep under 1000 characters.');
                return;
            }

            const options = getSelectedOptions();
            const generateBtn = document.getElementById('generateBtn');
            const loadingIndicator = document.getElementById('loadingIndicator');
            const outputsGrid = document.getElementById('outputsGrid');

            // Check if button is in cooldown
            if (generateBtn.disabled && generateBtn.textContent.includes('seconds')) {
                return;
            }

            // Show loading state
            generateBtn.disabled = true;
            generateBtn.textContent = 'Generating...';
            loadingIndicator.style.display = 'block';
            outputsGrid.style.display = 'none';
            document.getElementById('copyAllSection').style.display = 'none';

            try {
                // Create the prompt for Claude
                const prompt = createPrompt(originalPost, options, validatedLinks, internalNotes);
                
                // Call our secure Netlify function
                const response = await fetch("/.netlify/functions/generate-posts", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify({
                        prompt: prompt
                    })
                });

                // Debug: Log response details
                console.log('Response status:', response.status);
                console.log('Response headers:', response.headers);

                let data;
                try {
                    const responseText = await response.text();
                    console.log('Raw response:', responseText);
                    data = JSON.parse(responseText);
                } catch (parseError) {
                    console.error('JSON parse error:', parseError);
                    throw new Error(`Server returned invalid response. Status: ${response.status}. Please check the console for details.`);
                }
                
                if (!response.ok) {
                    if (response.status === 429) {
                        // Rate limited
                        const retryAfter = data.retryAfter || 60;
                        throw new Error(`${data.error}\n\nPlease try again in ${retryAfter} seconds.`);
                    } else if (response.status === 403) {
                        throw new Error('Access denied. Please refresh the page and try again.');
                    } else if (response.status === 400) {
                        throw new Error(data.error || 'Invalid request');
                    } else {
                        throw new Error(`Server error: ${response.status}. ${data.error || ''}`);
                    }
                }
                
                if (!data.success) {
                    showErrorFeedback(`Generation Error: ${data.error || 'Failed to generate posts'}`);
                    return;
                }
                
                const claudeResponse = data.content;

                // Check if Claude refused the content due to policy violations
                if (claudeResponse && (
                    claudeResponse.includes("I'm not able to help") ||
                    claudeResponse.includes("not appropriate for me to") ||
                    claudeResponse.includes("contains sexually suggestive") ||
                    claudeResponse.includes("explicit content") ||
                    claudeResponse.includes("I can't create content") ||
                    claudeResponse.includes("safety guidelines") ||
                    claudeResponse.includes("sexually explicit") ||
                    claudeResponse.includes("mature themes") ||
                    claudeResponse.includes("adult content")
                )) {
                    showContentPolicyFeedback();
                    return;
                }

                // Check for empty or very short responses (possible failures)
                if (!claudeResponse || claudeResponse.trim().length < 50) {
                    showErrorFeedback("Generation failed - received empty or incomplete response from Claude. Please try again with different content or settings.");
                    return;
                }

                // Parse and populate the outputs
                parseAndPopulateOutputs(claudeResponse);

                // Show results
                outputsGrid.style.display = 'grid';
                document.getElementById('copyAllSection').style.display = 'block';
                outputsGrid.scrollIntoView({ behavior: 'smooth' });

                // Start cooldown timer (30 seconds)
                startCooldown(30);

                // Show rate limit info if provided
                if (data.rateLimitRemaining !== undefined) {
                    console.log(`Rate limit: ${data.rateLimitRemaining} requests remaining (${data.dailyRemaining} daily)`);
                }

            } catch (error) {
                console.error('Error generating posts:', error);
                showErrorFeedback(`Generation failed: ${error.message}`);
            } finally {
                // Reset loading indicator
                loadingIndicator.style.display = 'none';
            }
        }

        // Show general error feedback in Instagram textbox
        function showErrorFeedback(errorMessage) {
            const platforms = ['instagramOutput', 'xOutput', 'linkedinOutput', 'mastodonOutput', 'blueskyOutput', 'tiktokOutput', 'blogOutput'];
            platforms.forEach(id => {
                document.getElementById(id).value = '';
            });

            const outputsGrid = document.getElementById('outputsGrid');
            outputsGrid.style.display = 'grid';
            
            const feedbackMessage = `‚ùå GENERATION ERROR

${errorMessage}

üîÑ WHAT TO TRY:
- Check your internet connection
- Make sure your content isn't too long
- Try different tone options
- Refresh the page if problems persist
- Wait a moment and try again

If the error continues, there may be a temporary issue with the service.`;

            document.getElementById('instagramOutput').value = feedbackMessage;
            outputsGrid.scrollIntoView({ behavior: 'smooth' });
        }

        // Show helpful feedback when Claude refuses content
        function showContentPolicyFeedback() {
            const platforms = ['instagramOutput', 'xOutput', 'linkedinOutput', 'mastodonOutput', 'blueskyOutput', 'tiktokOutput', 'blogOutput'];
            platforms.forEach(id => {
                document.getElementById(id).value = '';
            });

            const outputsGrid = document.getElementById('outputsGrid');
            outputsGrid.style.display = 'grid';
            
            const feedbackMessage = `‚ö†Ô∏è CONTENT TOO EXPLICIT FOR CLAUDE

Your content contains explicit language that Claude's safety guidelines won't allow, even with X-rated options enabled.

üéØ HOW TO MAKE IT WORK:

‚úÖ REPLACE EXPLICIT TERMS:
Instead of: "body", "feel each other", "penetrate", "climax"
Use: "presence", "connect", "immerse", "peak moment"

‚úÖ USE SUGGESTIVE METAPHORS:
Instead of: Direct sexual references
Try: "electric connection", "rising energy", "magnetic pull", "intense heat"

‚úÖ FOCUS ON EMOTIONS/SENSATIONS:
Instead of: Physical descriptions
Use: "overwhelming sensation", "breathless moment", "pulse racing", "electric anticipation"

‚úÖ CREATIVE OBJECT DESCRIPTIONS:
Instead of: Phallic references
Try: "sleek cylindrical design", "firm grip", "smooth curves", "powerful thrust (of innovation)"

üîÑ REFINEMENT STRATEGY:
1. Remove any body part references
2. Replace sexual verbs with emotional/technical terms
3. Use electronics metaphors (voltage, current, spark, surge)
4. Focus on feelings rather than actions
5. Let the X-rated option add the suggestive tone

üí° WORKING EXAMPLE:
Original: "LED earrings light up when we connect"
X-rated transform: "These accessories surge with electric energy when the connection is made"

Try rewriting your post using emotional/technical language and let the AI add the spice!`;

            document.getElementById('instagramOutput').value = feedbackMessage;
            outputsGrid.scrollIntoView({ behavior: 'smooth' });
        }
        async function copyAllPosts() {
            const platforms = [
                { name: 'INSTAGRAM', id: 'instagramOutput' },
                { name: 'X (TWITTER)', id: 'xOutput' },
                { name: 'LINKEDIN', id: 'linkedinOutput' },
                { name: 'MASTODON', id: 'mastodonOutput' },
                { name: 'BLUESKY', id: 'blueskyOutput' },
                { name: 'TIKTOK', id: 'tiktokOutput' },
                { name: 'BLOG POST', id: 'blogOutput' }
            ];

            let allContent = [];
            
            for (const platform of platforms) {
                const textarea = document.getElementById(platform.id);
                if (textarea && textarea.value.trim()) {
                    allContent.push(`=== ${platform.name} ===`);
                    allContent.push(textarea.value.trim());
                    allContent.push(''); // Empty line between platforms
                }
            }

            if (allContent.length === 0) {
                alert('No content to copy. Please generate posts first.');
                return;
            }

            const finalContent = allContent.join('\n');
            
            try {
                await navigator.clipboard.writeText(finalContent);
                
                // Update button to show success
                const copyAllBtn = document.getElementById('copyAllBtn');
                const originalText = copyAllBtn.textContent;
                copyAllBtn.textContent = '‚úÖ Copied All Posts!';
                copyAllBtn.classList.add('copied');
                
                setTimeout(() => {
                    copyAllBtn.textContent = originalText;
                    copyAllBtn.classList.remove('copied');
                }, 3000);
                
            } catch (err) {
                console.error('Failed to copy all posts: ', err);
                alert('Failed to copy to clipboard. Please try copying individual posts.');
            }
        }

        // Cooldown timer function
        function startCooldown(seconds) {
            const generateBtn = document.getElementById('generateBtn');
            let remainingSeconds = seconds;
            
            const countdown = () => {
                generateBtn.disabled = true;
                generateBtn.textContent = `Please wait ${remainingSeconds} seconds`;
                remainingSeconds--;
                
                if (remainingSeconds < 0) {
                    generateBtn.disabled = false;
                    generateBtn.textContent = 'Generate Adapted Posts';
                } else {
                    setTimeout(countdown, 1000);
                }
            };
            
            countdown();
        }
        function startCooldown(seconds) {
            const generateBtn = document.getElementById('generateBtn');
            let remainingSeconds = seconds;
            
            const countdown = () => {
                generateBtn.disabled = true;
                generateBtn.textContent = `Please wait ${remainingSeconds} seconds`;
                remainingSeconds--;
                
                if (remainingSeconds < 0) {
                    generateBtn.disabled = false;
                    generateBtn.textContent = 'Generate Adapted Posts';
                } else {
                    setTimeout(countdown, 1000);
                }
            };
            
            countdown();
        }

        function createPrompt(originalPost, options, referenceLinks = [], internalNotes = '') {
            // Combine all selected options into readable lists
            const allModifications = options.contentMods.concat(options.engagementElements);
            const allToneElements = options.tones.concat(options.languageVoice);
            
            // Format reference links section
            const linksSection = referenceLinks.length > 0 
                ? `\n\nREFERENCE LINKS to consider when adapting:\n${referenceLinks.map((link, index) => `${index + 1}. ${link}`).join('\n')}`
                : '';
            
            // Format internal notes section
            const notesSection = internalNotes.trim() 
                ? `\n\nINTERNAL NOTES (for guidance only - DO NOT include this content in final posts):\n${internalNotes.trim()}`
                : '';
            
            return `Please adapt the following social media post for different platforms using OPTIMAL character counts for maximum engagement.

Original post: "${originalPost}"${linksSection}${notesSection}

CONTENT MODIFICATIONS: ${allModifications.length > 0 ? allModifications.join(', ') : 'none selected'}
TONE & STYLE: ${allToneElements.length > 0 ? allToneElements.join(', ') : 'none selected'}
AUDIENCE FOCUS: ${options.audienceFocus.length > 0 ? options.audienceFocus.join(', ') : 'general audience'}

${referenceLinks.length > 0 ? 'IMPORTANT: When reference links are provided, naturally incorporate context from these links into the adapted posts where relevant. You can mention or reference the content, but do not include the actual URLs in the final posts unless specifically requested.' : ''}

${internalNotes.trim() ? 'CRITICAL: The internal notes above are private instructions to guide your adaptation. Use them to inform your approach, tone, and content focus, but NEVER include any of the internal notes text directly in your final posts.' : ''}

CRITICAL HUMAN-LIKE WRITING RULES - Follow these to make content undetectable as AI-written:
- NEVER use em dashes (‚Äî) - use regular hyphens (-) or other punctuation
- AVOID AI buzzwords: "delve," "leverage," "utilize," "furthermore," "moreover," "seamlessly," "unlock," "game-changer," "dive deep," "at the end of the day"
- NO corporate speak: "synergy," "paradigm," "cutting-edge," "state-of-the-art," "best practices," "holistic"
- Use contractions naturally: "don't," "won't," "can't," "it's," "you're"
- Include minor imperfections: occasional sentence fragments, casual grammar
- Use simple, everyday words instead of fancy alternatives
- Vary sentence lengths - mix short punchy sentences with longer ones
- Add authentic human touches: "honestly," "tbh," "ngl," "actually," "basically"
- AVOID perfect punctuation - humans sometimes skip commas or use ellipses...
- Use platform-specific slang naturally (but don't overdo it)
- Include genuine enthusiasm without being overly polished
- Make it sound like someone actually talking, not writing an essay
- PROFANITY RULE: ${options.languageVoice.includes('allow profanity when appropriate') ? 'You may use mild to moderate profanity when it fits the tone and platform (avoid extreme profanity). Use sparingly and authentically.' : 'Keep all content family-friendly with no profanity or strong language.'}

Please provide adaptations for these platforms with optimal character counts:

1. INSTAGRAM: 125 characters optimal, engaging visual-focused content
2. X/TWITTER: 71-100 characters optimal, concise and impactful
3. LINKEDIN: 100 characters optimal, professional networking tone  
4. MASTODON: 200-400 characters recommended, community-focused, thoughtful
5. BLUESKY: 200-250 characters recommended, conversational and authentic
6. TIKTOK: Brief engaging description for video context
7. BLOG POST: Longer-form expanded content (no character restrictions)

Format your response exactly like this:

**INSTAGRAM:**
[adapted content]

**X:**
[adapted content]

**LINKEDIN:**
[adapted content]

**MASTODON:**
[adapted content]

**BLUESKY:**
[adapted content]

**TIKTOK:**
[adapted content]

**BLOG:**
[adapted content]

Make sure each adaptation:
- Uses optimal character counts for maximum engagement
- Sounds genuinely human-written using the rules above
- Incorporates ALL selected modifications, tones, and audience focus appropriately
- ${referenceLinks.length > 0 ? 'References the provided links contextually where relevant' : 'Focuses on the original post content'}
- ${internalNotes.trim() ? 'Follows the guidance in the internal notes without including any of that text directly' : 'Stays true to the original post intent'}
- Matches the platform's audience and tone
- Maintains the core message while optimizing for platform-specific engagement`;
        }

        function parseAndPopulateOutputs(claudeResponse) {
            try {
                // Parse the structured response
                const platforms = {
                    'INSTAGRAM:': 'instagramOutput',
                    'X:': 'xOutput', 
                    'LINKEDIN:': 'linkedinOutput',
                    'MASTODON:': 'mastodonOutput',
                    'BLUESKY:': 'blueskyOutput',
                    'TIKTOK:': 'tiktokOutput',
                    'BLOG:': 'blogOutput'
                };

                const lines = claudeResponse.split('\n');
                let currentPlatform = null;
                let currentContent = [];

                for (let line of lines) {
                    line = line.trim();
                    
                    // Check if this line starts a new platform section
                    let foundPlatform = null;
                    for (let platform in platforms) {
                        if (line.includes('**' + platform) || line.includes(platform)) {
                            foundPlatform = platform;
                            break;
                        }
                    }

                    if (foundPlatform) {
                        // Save previous platform content
                        if (currentPlatform && currentContent.length > 0) {
                            const textareaId = platforms[currentPlatform];
                            const textarea = document.getElementById(textareaId);
                            if (textarea) {
                                textarea.value = currentContent.join('\n').trim();
                                // Trigger character count update
                                textarea.dispatchEvent(new Event('input'));
                            }
                        }
                        
                        // Start new platform
                        currentPlatform = foundPlatform;
                        currentContent = [];
                    } else if (currentPlatform && line && !line.includes('**')) {
                        currentContent.push(line);
                    }
                }

                // Don't forget the last platform
                if (currentPlatform && currentContent.length > 0) {
                    const textareaId = platforms[currentPlatform];
                    const textarea = document.getElementById(textareaId);
                    if (textarea) {
                        textarea.value = currentContent.join('\n').trim();
                        // Trigger character count update
                        textarea.dispatchEvent(new Event('input'));
                    }
                }

            } catch (error) {
                console.error('Error parsing Claude response:', error);
                
                // Fallback: just put the raw response in the first textarea
                document.getElementById('instagramOutput').value = claudeResponse;
            }
        }
    </script>
</body>
</html>
